
# DM2023 3-3-2 客流规划


## 问题描述

大型主题公园的游览路线，除了需要考虑展出效果，还需要对人流量有所规划，在实际展出中加以限制，以避免人群拥挤，提高游客体验的同时减小安全风险。你受邀为某公园的人流量规划提供数据分析支持，园方希望获知游客总流量最大会是多少。

你收到举办方的公园路线图，图中有 n 个展馆，1 个公园入口，1 个公园出口，共计 n + 2 个地点。在一些地点之间有单向的观光道相连。观光道之所以为单向，是因为主办方希望引导游客选择最佳的游览顺序。每个展馆周边，同时有进入该展馆的观光道和离开该展馆的观光道。

你决定采用如下的假设，模拟游客的游览过程：

    1.游客从公园入口进入。
    2.选择任意一条从当前位置出发的观光道，若游客到达出口，则游览结束。否则进行下一步。
    3.若前往展馆，参观完毕后从该展馆离开，回到第二步再度选择一条观光道。

此外，游客会按照引导顺序游览，不会在观光道上停留，不会不顾人数限制强行冲入场馆。

在展馆人数已满的情况下，展馆人数维持稳定，游客出馆速率等于入馆速率，是你计算最大人流量的前提假设。每个展馆控制馆内进入游客的速率，i 号展馆（1 ≤ i ≤ n）每分钟放行 ai 人。由检票速度限制，公园入口的游客放行速率稳定为 a0，出口不限制游客放行速率。公园里有一些狭窄的观光道，通行速率为每分钟 we 人（观光道 e 是一条狭窄观光道）。其他观光道都足够宽阔，可以忽略它对通行速率的限制。

公园处在最大运行负荷下，达到最大可能的游客总流量，园方希望你计算一下此时公园的游客总流量是每分钟多少人。
## 输入格式

从标准输入读取数据。

输入 m + 2 行。第一行包含 2 个整数，分别为展馆数量 n 和观光道数量 m。

第二行包含 n + 1 个整数，依次为 a0, a1, a2, ..., an，含义参见问题描述部分。

第三行至 m + 2 行每行包含三个整数 u, v, w，表示存在一条从 u 到 v 的单向观光道。 特别地，将入口视作展馆 0，将出口视作展馆 n + 1，故 u, v 是 0 ~ n + 1 的整数。如果 w = -1，则这是一条宽阔观光道；否则 w ≥ 0，表示这是一条狭窄观光道，限制通行速率为每分钟 w 人。
输出格式

输出到标准输出。

输出一行，包含一个整数，为最大运行负荷下公园的游客总流量，单位为人每分钟。
样例输入

```c++
4 10
20 16 10 10 8
0 1 8
0 2 12
1 2 8
1 3 3
2 4 -1
2 4 4
3 5 10
4 1 -1
4 3 10
4 5 10
```
## 样例输出
```c++
11
```

## 数据范围与约定

n ≤ 40, m ≤ 800

0 ≤ ai ≤ 109

对于每条观光道，0 ≤ u ≤ n, 1 ≤ v ≤ n + 1, 0 ≤ w ≤ 109 或 w = -1

时间限制：1 秒

内存限制：256 MiB
